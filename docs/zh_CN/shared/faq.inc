.. only:: esp32

    为什么电源纹波并不大，但射频的 TX 性能很差？
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

    **现象分析：** 电源纹波可极大地影响射频的 TX 性能。测量电源纹波时需注意电源纹波必须是在 {IDF_TARGET_NAME} 正常发包下测试。随着不同模式下功率的改变，电源纹波也会随之变化，发包功率越高，导致的纹波越大。

    一般情况下，发送 MCS7\@11n 的包时，电源纹波峰峰值必须 <80 mV。发送 11 MHz\@11b 的包时，电源纹波峰峰值必须 <120 mV。

    **解决方法：** 在电源支路上（支路为 {IDF_TARGET_NAME} 模拟电源管脚）添加一个 10 μF 的滤波电容。10 μF 的电容必须靠近芯片的模拟电源管脚，越近纹波会越小越稳定。

为什么芯片发包时，电源纹波很小，但射频的 TX 性能不好？
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**现象分析：** 射频的 TX 性能不仅受电源纹波的影响，还受到晶振的影响。晶振的本身质量不好，频偏过大会影响射频的 TX 性能。或者晶振受到高频信号干扰，比如晶振的输入输出信号线走线跨层交叉，使得晶振的输入信号耦合到输出信号上，输出信号耦合到输入信号上，也会影响射频的 TX 性能。另外，如果晶振的下方有其他高频信号走线，比如 SDIO 走线、UART 走线，也会导致晶振无法正常工作。最后，晶振旁边有感性器件或辐射器件，比如大电感、天线等也会导致芯片的射频性能不好。

**解决方法：** 此问题主要是在布局上，可以重新布局，详见章节 :ref:`晶振 <crystal-layout>`。

为什么芯片发包时，仪器测试到的 power 值比 target power 值要高很多或者低很多，且 EVM 比较差？
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**现象分析：** 仪器检测到的 power 值与 target power 相差较大，可能是由于芯片射频管脚输出到天线这一段传输线上阻抗不匹配导致信号在传输过程中有反射。其次，阻抗不匹配会影响到芯片内部 PA 的工作状态，使得 PA 非正常过早进入饱和区域，继而使得信号失真度高，EVM 自然会变差。

**解决方法：** 射频走线上预留了一个 π 型电路，可以根据需求对天线进行阻抗匹配，使得从芯片射频管脚往天线端看去，阻抗接近芯片端口阻抗。

为什么芯片的 TX 性能没有问题，但 RX 的灵敏度不好？
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**现象分析：** 芯片的 TX 性能没有问题意味着射频端的阻抗匹配也没有问题。RX 灵敏度不好的可能原因是外界干扰耦合到天线上，比如晶振离天线非常近，或是 UART 的 TX 与 RX 走线穿过射频走线等。另外，如果主板上存在非常多的高频信号干扰源，则需根据主板设计来考量信号完整性的问题。

**解决方法：** 请确保天线远离晶振，且射频走线附近不要走高频信号，具体可参考章节 :ref:`射频 <rf-layout>`。